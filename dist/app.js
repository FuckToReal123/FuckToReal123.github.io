!function(e){var t={};function o(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=t,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(i,n,function(t){return e[t]}.bind(null,n));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";o.r(t);var i=0;function n(e,t){this.value=e,this.position={vertical:t.vertical,horizontal:t.horizontal},this.id=i,i+=1}n.prototype.move=function(e,t){this.position.horizontal+=t,this.position.vertical+=e},n.prototype.setValue=function(e){this.value=e};var r=n;function l(e){this.htmlElemnt=document.getElementById("playfield"),this.size=e,this.elements=[]}l.prototype.refresh=function(){for(var e="",t=this.htmlElemnt.getElementsByClassName("thing");t[0];)t[0].parentNode.removeChild(t[0]);this.elements.forEach(function(t){e+='<div class="thing t'+t.value+'" id="'+t.id+'" style="top: '+t.position.vertical+"px; left: "+t.position.horizontal+'px;"></div>'}),this.htmlElemnt.innerHTML+=e},l.prototype.insertElement=function(e){this.elements.push(e)},l.prototype.getRandomFreeCell=function(){for(var e=[],t=0;t<this.size;t++)for(var o=0;o<this.size;o++){var i={vertical:100*t,horizontal:100*o};this.isCellFree(i)&&e.push(i)}return e[parseInt(100*Math.random()%e.length)]},l.prototype.isFreeCells=function(){return this.elements.length!==Math.pow(this.size,2)},l.prototype.addElement=function(){this.isFreeCells()&&(Math.random()<.9?this.insertElement(new r(2,this.getRandomFreeCell())):this.insertElement(new r(4,this.getRandomFreeCell())),this.refresh())},l.prototype.isCellFree=function(e){var t=!0;return this.getElementByPosition(e)&&(t=!1),t},l.prototype.getElementByPosition=function(e){return this.elements.find(function(t){return!t.merged&&t.position.vertical==e.vertical&&t.position.horizontal==e.horizontal})},l.prototype.getElementById=function(e){return this.elements.find(function(t){return t.id==e})};var s=l;function a(e){this.field=new s(e),this.moveVector={x:0,y:0,compareFunc:void 0}}a.prototype.validatePosition=function(e){var t={vertical:0,horizontal:0};return e.vertical>100*(this.field.size-1)?t.vertical=100*(this.field.size-1):e.vertical<0?t.vertical=0:t.vertical=e.vertical,e.horizontal>100*(this.field.size-1)?t.horizontal=100*(this.field.size-1):e.horizontal<0?t.horizontal=0:t.horizontal=e.horizontal,t},a.prototype.moveElements=function(){var e=this,t=100*e.moveVector.y,o=100*e.moveVector.x,i=0;e.field.elements.sort(e.moveVector.compareFunc),e.field.elements.forEach(function(n,r,l){for(var s={vertical:n.position.vertical+t,horizontal:n.position.horizontal+o};e.field.isCellFree(e.validatePosition(s));)n.move(t,o),i+=1,s.vertical+=t,s.horizontal+=o;var a=e.field.getElementByPosition(e.validatePosition(s));n.value==a.value&&n.id!=a.id&&(a.setValue(2*n.value),l[r].merged=!0,i+=1)}),e.field.elements=e.field.elements.filter(function(e){return!e.merged}),0!==i?e.field.addElement():this.field.isFreeCells()||alert("Game Over!")},a.prototype.init=function(){var e=this,t=0,o=0,i=0,n=0;window.onmousedown=function(e){t=e.clientX,o=e.clientY},window.onmouseup=function(r){i=r.clientX,n=r.clientY,(Math.abs(t-i)>50||Math.abs(o-n)>50)&&(e.getMoveVector(t,i,o,n),e.moveElements())},e.field.addElement()},a.prototype.getMoveVector=function(e,t,o,i){Math.abs(t-e)>Math.abs(i-o)?e<t?(this.moveVector.x=1,this.moveVector.y=0,this.moveVector.compareFunc=function(e,t){return t.position.horizontal-e.position.horizontal}):(this.moveVector.x=-1,this.moveVector.y=0,this.moveVector.compareFunc=function(e,t){return e.position.horizontal-t.position.horizontal}):o<i?(this.moveVector.x=0,this.moveVector.y=1,this.moveVector.compareFunc=function(e,t){return t.position.vertical-e.position.vertical}):(this.moveVector.x=0,this.moveVector.y=-1,this.moveVector.compareFunc=function(e,t){return e.position.vertical-t.position.vertical})};new a(4).init()}]);