!function(t){var e={};function i(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(o,n,function(e){return t[e]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var o=0;function n(t,e){this.value=t,this.position={vertical:e.vertical,horizontal:e.horizontal},this.htmlElement,this.id=o,o+=1}n.prototype.move=function(t){this.htmlElemnt=document.getElementById(this.id),this.position.horizontal=t.horizontal,this.position.vertical=t.vertical;$(this.htmlElemnt).animate({left:this.position.horizontal+"px",top:this.position.vertical+"px"},450)},n.prototype.setValue=function(t){this.value=t};var r=n;function l(t){this.htmlElemnt=document.getElementById("playfield"),this.size=t,this.elements=[]}l.prototype.refresh=function(){var t=this,e="";setTimeout(function(){for(var i=t.htmlElemnt.getElementsByClassName("thing");i[0];)i[0].parentNode.removeChild(i[0]);t.elements.forEach(function(t){e+='<div class="thing t'+t.value+'" id="'+t.id+'" style="top: '+t.position.vertical+"px; left: "+t.position.horizontal+'px;"></div>'}),t.htmlElemnt.innerHTML+=e},500)},l.prototype.insertElement=function(t){this.elements.push(t)},l.prototype.getRandomFreeCell=function(){for(var t=[],e=0;e<this.size;e++)for(var i=0;i<this.size;i++){var o={vertical:100*e,horizontal:100*i};this.isCellFree(o)&&t.push(o)}return t[parseInt(100*Math.random()%t.length)]},l.prototype.isFreeCells=function(){return this.elements.length!==Math.pow(this.size,2)},l.prototype.addElement=function(){this.isFreeCells()&&(Math.random()<.9?this.insertElement(new r(2,this.getRandomFreeCell())):this.insertElement(new r(4,this.getRandomFreeCell())),this.refresh())},l.prototype.isCellFree=function(t){var e=!0;return this.getElementByPosition(t)&&(e=!1),e},l.prototype.getElementByPosition=function(t){return this.elements.find(function(e){return!e.merged&&e.position.vertical==t.vertical&&e.position.horizontal==t.horizontal})},l.prototype.getElementById=function(t){return this.elements.find(function(e){return e.id==t})};var s=l;function a(t){this.field=new s(t),this.moveVector={x:0,y:0,compareFunc:void 0}}a.prototype.validatePosition=function(t){var e={vertical:0,horizontal:0};return t.vertical>100*(this.field.size-1)?e.vertical=100*(this.field.size-1):t.vertical<0?e.vertical=0:e.vertical=t.vertical,t.horizontal>100*(this.field.size-1)?e.horizontal=100*(this.field.size-1):t.horizontal<0?e.horizontal=0:e.horizontal=t.horizontal,e},a.prototype.isMoveAvalible=function(t){var e=this.validatePosition(t);return this.field.isCellFree(t)&&t.vertical==e.vertical&&t.horizontal==e.horizontal},a.prototype.moveElements=function(){var t=this,e=100*t.moveVector.y,i=100*t.moveVector.x,o=0;t.field.elements.sort(t.moveVector.compareFunc),t.field.elements.forEach(function(n,r,l){for(var s={vertical:n.position.vertical+e,horizontal:n.position.horizontal+i};t.isMoveAvalible(s);)o+=1,s.vertical+=e,s.horizontal+=i;n.move(t.validatePosition(s));var a=t.field.getElementByPosition(t.validatePosition(s));n.value==a.value&&n.id!=a.id&&(a.setValue(2*n.value),l[r].merged=!0,o+=1)}),t.field.elements=t.field.elements.filter(function(t){return!t.merged}),0!==o?t.field.addElement():this.field.isFreeCells()||alert("Game Over!")},a.prototype.init=function(){var t=this,e=0,i=0,o=0,n=0;window.onmousedown=function(t){e=t.clientX,i=t.clientY},window.onmouseup=function(r){o=r.clientX,n=r.clientY,(Math.abs(e-o)>50||Math.abs(i-n)>50)&&(t.getMoveVector(e,o,i,n),t.moveElements())},t.field.addElement()},a.prototype.getMoveVector=function(t,e,i,o){Math.abs(e-t)>Math.abs(o-i)?t<e?(this.moveVector.x=1,this.moveVector.y=0,this.moveVector.compareFunc=function(t,e){return e.position.horizontal-t.position.horizontal}):(this.moveVector.x=-1,this.moveVector.y=0,this.moveVector.compareFunc=function(t,e){return t.position.horizontal-e.position.horizontal}):i<o?(this.moveVector.x=0,this.moveVector.y=1,this.moveVector.compareFunc=function(t,e){return e.position.vertical-t.position.vertical}):(this.moveVector.x=0,this.moveVector.y=-1,this.moveVector.compareFunc=function(t,e){return t.position.vertical-e.position.vertical})};new a(4).init()}]);