!function(e){var t={};function o(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=t,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(i,n,function(t){return e[t]}.bind(null,n));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";o.r(t);var i={DEFAULT_GAME_FIELD_SIZE:4,DEFAULT_GAME_ITEM_SIZE:100,GAME_ITEM_MOVE_DURATION:400,GAME_FIELD_REFRESH_DURATION:420,MINIMAL_MOUSE_SHIFT:50,GAME_ITEM_HTML_CLASS:"thing",GAME_FIELD_HTML_CLASS:"playfield"};function n(){}n.refreshField=function(e){var t=document.getElementById(i.GAME_FIELD_HTML_CLASS),o="";setTimeout(function(){for(var n=t.getElementsByClassName(i.GAME_ITEM_HTML_CLASS);n[0];)n[0].parentNode.removeChild(n[0]);e.elements.forEach(function(e){o+='<div class="'+i.GAME_ITEM_HTML_CLASS+" t"+e.value+'" id="'+e.id+'" style="top: '+e.position.vertical+"px; left: "+e.position.horizontal+'px;"></div>'}),t.innerHTML+=o},i.GAME_FIELD_REFRESH_DURATION)},n.moveGameItem=function(e){var t=document.getElementById(e.id);$(t).animate({left:e.position.horizontal+"px",top:e.position.vertical+"px"},i.GAME_ITEM_MOVE_DURATION)};var r=n,l=0;function a(e,t){this.value=e,this.position={vertical:t.vertical,horizontal:t.horizontal},this.htmlElement,this.id=l,l+=1}a.prototype.move=function(e){this.htmlElemnt=document.getElementById(this.id),this.position.horizontal=e.horizontal,this.position.vertical=e.vertical;r.moveGameItem(this)},a.prototype.setValue=function(e){this.value=e};var s=a,c={randomInt:function(e,t){var o=e+Math.random()*(t+1-e);return o=Math.floor(o)}};function h(e){this.size=e,this.elements=[]}h.prototype.refresh=function(){r.refreshField(this)},h.prototype.insertElement=function(e){this.elements.push(e)},h.prototype.getRandomFreeCell=function(){for(var e=[],t=i.DEFAULT_GAME_ITEM_SIZE,o=0;o<this.size;o++)for(var n=0;n<this.size;n++){var r={vertical:o*t,horizontal:n*t};this.isCellFree(r)&&e.push(r)}return e[c.randomInt(0,e.length-1)]},h.prototype.isFreeCells=function(){return this.elements.length!==Math.pow(this.size,2)},h.prototype.addElement=function(){this.isFreeCells()&&(Math.random()<.9?this.insertElement(new s(2,this.getRandomFreeCell())):this.insertElement(new s(4,this.getRandomFreeCell())),this.refresh())},h.prototype.isCellFree=function(e){var t=!0;return this.getElementByPosition(e)&&(t=!1),t},h.prototype.getElementByPosition=function(e){return this.elements.find(function(t){return!t.merged&&t.position.vertical==e.vertical&&t.position.horizontal==e.horizontal})};var u=h;function v(e){this.field=new u(e),this.moveVector={x:0,y:0,compareFunc:void 0}}v.prototype.makePositionValid=function(e){var t={vertical:0,horizontal:0};return e.vertical>(this.field.size-1)*i.DEFAULT_GAME_ITEM_SIZE?t.vertical=(this.field.size-1)*i.DEFAULT_GAME_ITEM_SIZE:e.vertical<0?t.vertical=0:t.vertical=e.vertical,e.horizontal>(this.field.size-1)*i.DEFAULT_GAME_ITEM_SIZE?t.horizontal=(this.field.size-1)*i.DEFAULT_GAME_ITEM_SIZE:e.horizontal<0?t.horizontal=0:t.horizontal=e.horizontal,t},v.prototype.isMoveAvalible=function(e){var t=this.makePositionValid(e);return this.field.isCellFree(e)&&e.vertical==t.vertical&&e.horizontal==t.horizontal},v.prototype.moveElements=function(){var e=this,t=e.moveVector.y*i.DEFAULT_GAME_ITEM_SIZE,o=e.moveVector.x*i.DEFAULT_GAME_ITEM_SIZE,n=0;e.field.elements.sort(e.moveVector.compareFunc),e.field.elements.forEach(function(r,l,a){for(var s={vertical:r.position.vertical,horizontal:r.position.horizontal},c={vertical:r.position.vertical+t,horizontal:r.position.horizontal+o};e.isMoveAvalible(c);)n+=1,s.horizontal=c.horizontal,s.vertical=c.vertical,c.vertical+=t,c.horizontal+=o;var h=e.field.getElementByPosition(e.makePositionValid(c));if(h&&r.value==h.value&&r.id!=h.id){h.setValue(2*r.value);var u=0==e.moveVector.y?0:i.DEFAULT_GAME_ITEM_SIZE/2,v=0==e.moveVector.x?0:i.DEFAULT_GAME_ITEM_SIZE/2,m={vertical:e.makePositionValid(c).vertical-u,horizontal:e.makePositionValid(c).horizontal-v};r.move(e.makePositionValid(m)),a[l].merged=!0,n+=1}else r.move(e.makePositionValid(s))}),e.field.elements=e.field.elements.filter(function(e){return!e.merged}),0!==n?e.field.addElement():this.field.isFreeCells()||alert("Game Over!")},v.prototype.init=function(){var e=this,t=0,o=0,n=0,r=0;window.onmousedown=function(e){t=e.clientX,o=e.clientY},window.onmouseup=function(l){n=l.clientX,r=l.clientY,(Math.abs(t-n)>i.MINIMAL_MOUSE_SHIFT||Math.abs(o-r)>i.MINIMAL_MOUSE_SHIFT)&&(e.setMoveVector(t,n,o,r),e.moveElements())},e.field.addElement()},v.prototype.setMoveVector=function(e,t,o,i){Math.abs(t-e)>Math.abs(i-o)?e<t?(this.moveVector.x=1,this.moveVector.y=0,this.moveVector.compareFunc=function(e,t){return t.position.horizontal-e.position.horizontal}):(this.moveVector.x=-1,this.moveVector.y=0,this.moveVector.compareFunc=function(e,t){return e.position.horizontal-t.position.horizontal}):o<i?(this.moveVector.x=0,this.moveVector.y=1,this.moveVector.compareFunc=function(e,t){return t.position.vertical-e.position.vertical}):(this.moveVector.x=0,this.moveVector.y=-1,this.moveVector.compareFunc=function(e,t){return e.position.vertical-t.position.vertical})},new v(i.DEFAULT_GAME_FIELD_SIZE).init()}]);